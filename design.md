## 核心功能
- 使用goscript2作为脚本引擎，将sql文本编译为go代码，并渲染出string和args
- goscript2源码位于 D:\code\goscript2 请暂时使用replace方式进行引入本地

## 基本
- sql模板使用markdown文件进行存储
- markdown的一级标题为命名空间，二级标题为sql名称，从```sql开始为sql模板的内容，到```结束，例如
```
# namespace
这里为一些说明
## sqlname
这里为一些说明
```sql
select * from table 
where id = @id
@if a > 0 {
    and names in (@names)
@}
```

## 指令说明
- @ + 连贯单词（包括_）表示输出 ? 和 参数， 如果需要表达式或者方法，则需要使用@+expr+@包括，例如 @ GetName() @
如果返回值是数组，则输出多个? 和 多个参数
- @= + 连贯单词（包括_）表示直接输出值， 如果需要表达式或者方法，则需要使用@=+expr+@包括，例如 @= GetName() @
- @if @else if @else @for i,v := range (和go代码一样) + {} 用于流程控制，此时，系统会自动识别对照的 }
- @+{} 用于直接输入go代码
- 如果一个表达式（不论是 @xx 还是 @xx@）以?结尾，则表示该表达式所在行需要被条件控制，如果条件为true，则输出该表达式，否则不输出，判断依据是：如果是string类型，则判断是否为空，如果是数组，则判断是否为空(长度为0)，如果是bool，判断是否为false，如果不存在这个字段，则也认为是空 （所有判断的前提都是有这个字段）

## 特殊指令
- @use a.b {} 表示引用a命名空间下b的sql
- @define name {} 用于标记一个代码块，如果该块没有被hook，则默认输出对应的内容
- @cover name {} 只能位于use的代码块，表示重写目标片段中对应define的部分
- 用户也可以使用自定义函数作为指令，例如 @ GetAbc() {} 此时块内的元素会解析完作为query变成该函数的最后一个入参

## scope
- 如果为结构体，需要允许直接调用该结构体的方法（值或指针接收都要支持）,方式和普通方法类似，同理针对内嵌的结构也要支持
- 允许读取该结构体的私有字段

## 示例
请参考 example.md

## 解析
如果sql解析错误，需要明确标明是哪里错了，包括上下文片段告知用户

## 缓存
请尽可能使用缓存（包括反射），避免重复解析

## 性能
请在不影响功能的前提下做极致的性能优化

## api

#### 
- 提供一个GetSql("a.b", args) 函数，返回query,err
- query 包含sql和params
- arg为any类型，为模板渲染的scope

####
- 注册函数，可以向当前作用域新注册函数
